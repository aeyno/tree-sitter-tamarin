theory Yubikey
begin

section{* The Yubikey-Protocol *}

/*
 * Protocol:    Yubikey Protocol
 * Modeler:     Robert Kunnemann, Graham Steel
 * Date:    August 2012
 *
 * Status:  working
*/

functions: S/1,myzero/0

builtins: symmetric-encryption, asymmetric-encryption

equations:  id(a)=a,
            aeaddec(aeadenc(m, k, n, a), k, n, a) = m 

/* The following rules model two binary relations between integers. !Succ
 * is functional. If !Succ(a,b), then the adversary was able to show that b
 * is the successor of b. Similarly, albeit !Smaller is not functional, if
 * !Smaller(a,b), then the adversary was able to show that a is smaller
 * than b.
 * The Theory() action is used to enforce that this relation (to the extend
 * it is needed in this trace) has to be build up before running the first
 * protocol actions.
*/
rule InitSucc:
    [In(myzero),In(S(myzero))]
	 --[Theory(), IsSucc(myzero,S(myzero)),IsZero(myzero)]->
	[!Succ(myzero,S(myzero))]



lemma test [reuse, use_induction]:
"
 Ex A B #i #j. Truc(A,B)@i ==> Bidule(B,A)@j
"

end
